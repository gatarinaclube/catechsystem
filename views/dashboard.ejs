<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <title>Dashboard - CaTech</title>

    <!-- CSS GLOBAL -->
    <link rel="stylesheet" href="/css/theme.css" />
    <link rel="stylesheet" href="/css/layout.css" />
  </head>
  <body>
  <div class="shell">
    <%- include('partials/sidebar', { user, currentPath }) %>

    <main class="main">
        <div class="main-header">
          <div>
            <h2 class="welcome-title">
              OlÃ¡,
              <%= user && user.name ? user.name.split(" ")[0] : "criador" %> ğŸ‘‹
            </h2>
            <div class="welcome-sub">
              Use o menu ao lado para acessar seus gatos e outros
              recursos do CaTech.
            </div>
          </div>
          <div class="actions">
            <a href="/cats/new" class="btn-primary btn">+ Novo gato</a>
            <a href="/cats" class="btn">
  <%= (user && user.role === "ADMIN") ? "Ver todos os gatos" : "Ver meus gatos" %>
</a>
          </div>
        </div>

        <% if (user && user.role === "ADMIN" && catsInReviewCount > 0) { %>
  <div class="content-card" style="border-left: 4px solid #f59e0b; margin-bottom: 20px;">
    <div class="content-title" style="display:flex; align-items:center; gap:8px;">
      âš ï¸ NotificaÃ§Ãµes
    </div>

    <div class="content-sub" style="margin-top:6px;">
      Existem
      <strong><%= catsInReviewCount %></strong>
      gato(s) com status
      <strong>Em anÃ¡lise</strong>
      aguardando revisÃ£o.
    </div>

    <div style="margin-top:10px;">
      <a href="/cats?status=NOVO" class="btn btn-warning">
        Revisar agora â†’
      </a>
    </div>
  </div>
<% } %>

<% if (user && user.role === "ADMIN" && usersPendingApprovalCount > 0) { %>
  <div class="content-card" style="border-left: 4px solid #dc2626; margin-bottom: 20px;">
    <div class="content-title">ğŸ‘¤ Novos cadastros</div>
    <div class="content-sub">
      Existem
      <strong><%= usersPendingApprovalCount %></strong>
      usuÃ¡rio(s) aguardando anÃ¡lise de cadastro.
    </div>
    <div style="margin-top:10px;">
      <a href="/users" class="btn btn-danger">
        Analisar cadastros â†’
      </a>
    </div>
  </div>
<% } %>


<% if (user && user.role === "ADMIN" && servicesPendingFFBCount > 0) { %>
  <div class="content-card" style="border-left: 4px solid #2563eb; margin-bottom: 20px;">
    <div class="content-title">ğŸ“„ ServiÃ§os FFB</div>
    <div class="content-sub">
      Existem
      <strong><%= servicesPendingFFBCount %></strong>
      serviÃ§o(s) enviados para a Gatarina aguardando conferÃªncia.
    </div>
    <div style="margin-top:10px;">
      <a href="/ffb-services" class="btn btn-primary">
        Ver serviÃ§os â†’
      </a>
    </div>
  </div>
<% } %>

<% if (user && user.role !== "ADMIN" && pendingServicesCount > 0) { %>
  <div class="content-card" style="border-left: 4px solid #f59e0b; margin-bottom: 20px;">
    <div class="content-title" style="display:flex; align-items:center; gap:8px;">
      âš ï¸ ServiÃ§o com pendÃªncia
    </div>

    <div class="content-sub" style="margin-top:6px;">
      VocÃª possui <strong><%= pendingServicesCount %></strong> serviÃ§o(s) com pendÃªncia.
    </div>

    <div style="margin-top:10px; display:flex; flex-direction:column; gap:10px;">
      <% pendingServices.forEach(function(s) { 
        const st = s.statuses?.[0];
      %>
        <div style="padding:10px; border:1px solid #eee; border-radius:10px;">
          <div style="font-size:13px;">
            <strong><%= s.type %></strong>
          </div>

          <div style="font-size:12px; color:#666; margin-top:4px;">
            Mensagem do administrador:
          </div>

          <div style="font-size:12px; margin-top:4px; white-space:pre-wrap;">
            <%= (st && st.pendingNote) ? st.pendingNote : "Sem mensagem." %>
          </div>

          <div style="margin-top:8px;">
            <a href="/my-services/<%= s.id %>" class="btn btn-warning">Ver serviÃ§o â†’</a>
          </div>
        </div>
      <% }) %>
    </div>
  </div>
<% } %>




        <div class="content-card">
          <div class="content-title">Atalhos rÃ¡pidos</div>
          <div class="content-sub">
            GerÃªncie seus gatos nos atalhos abaixo.
          </div>

          <div class="quick-grid">
            <div class="quick-card">
              <div class="quick-label">Principal</div>
              <div class="quick-value">Meus gatos</div>
              <div class="quick-link">
                <a href="/cats">Acessar lista de gatos â†’</a>
              </div>
            </div>

            <div class="quick-card">
              <div class="quick-label">Cadastro</div>
              <div class="quick-value">Adicionar novo gato</div>
              <div class="quick-link">
                <a href="/cats/new">Ir para cadastro â†’</a>
              </div>
            </div>

            <% if (user && user.role === "ADMIN") { %>
              <div class="quick-card">
                <div class="quick-label">Admin</div>
                <div class="quick-value">ServiÃ§os FFB</div>
                <div class="quick-link">
                  <a href="/ffb-services">Ver registros de ninhada â†’</a>
                </div>
              </div>
            <% } %>
          </div>
        </div>

        <div class="content-card" style="margin-top:20px;">
  <div class="content-title">ğŸ’° Valores dos ServiÃ§os</div>
  <div class="content-sub">
    Os serviÃ§os sÃ£o encaminhados por malote para FFB a cada 15 dias (Normalmente dias 10 e 25).
  </div>

  <div style="margin-top:12px;">
    <div class="service-price-row">
      <span>AdmissÃ£o Associado</span>
      <strong>R$ 200,00</strong>
    </div>

    <div class="service-price-row">
      <span>Anuidade (Agosto - Julho)</span>
      <strong>R$ 300,00</strong>
    </div>

    <div class="service-price-row">
      <span>Registro de Gatil</span>
      <strong>R$ 220,00</strong>
    </div>

    <div class="service-price-row">
      <span>Mapa de Ninhada (Por Pedigree/Filhote)</span>
      <strong>R$ 40,00</strong>
    </div>

    <div class="service-price-row">
      <span>HomologaÃ§Ã£o Pedigree Nacional</span>
      <strong>R$ 120,00</strong>
    </div>

    <div class="service-price-row">
      <span>HomologaÃ§Ã£o Pedigree Internacional</span>
      <strong>R$ 150,00</strong>
    </div>

    <div class="service-price-row">
      <span>TransferÃªncia de Propriedade</span>
      <strong>R$ 35,00</strong>
    </div>

    <div class="service-price-row">
      <span>HomologaÃ§Ã£o de TÃ­tulo</span>
      <strong>R$ 35,00</strong>
    </div>

    <div class="service-price-row">
      <span>Cancelamento de Gatil</span>
      <strong>R$ 40,00</strong>
    </div>

    <div class="service-price-row">
      <span>Demais ServiÃ§os:</span>
      <strong>Consultar</strong>
    </div>
  </div>
</div>


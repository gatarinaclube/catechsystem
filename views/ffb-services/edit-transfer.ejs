<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Editar Transfer√™ncia de Propriedade - CaTech</title>

  <!-- CSS GLOBAL -->
  <link rel="stylesheet" href="/css/theme.css" />
  <link rel="stylesheet" href="/css/layout.css" />
  <link rel="stylesheet" href="/css/ffb-edit.css" />
</head>

<body>
  <div class="shell">
    <%- include('../partials/sidebar', { user, currentPath }) %>

    <main class="main">
      <div style="max-width: 1100px; margin: 0 auto;">

        <!-- HEADER -->
        <div class="main-header">
          <div>
            <h2 class="welcome-title">
              Servi√ßo FFB #<%= service.id %> ‚Äî Transfer√™ncia de Propriedade
            </h2>
            <div class="welcome-sub">
              Edi√ß√£o administrativa do pedido de transfer√™ncia.
            </div>
          </div>

          <div class="header-actions">
            <a href="/ffb-services" class="btn">‚Üê Voltar</a>
            <a href="/ffb-services/<%= service.id %>/bundle" class="btn btn-primary">
              üìÑ Gerar PDF
            </a>
          </div>
        </div>

        <!-- FORM -->
        <form method="POST" action="/ffb-services/<%= service.id %>/edit">

          <!-- ===================== DADOS DO SERVI√áO ===================== -->
          <div class="section-card">
            <div class="section-title">DADOS DO SERVI√áO</div>

            <div class="section-grid">
              <div class="form-row">
                <label>ID do servi√ßo</label>
                <input type="text" value="<%= service.id %>" readonly />
              </div>

              <div class="form-row">
                <label>Status</label>
                <select name="status">
                  <option value="ENVIADO_GATARINA" <%= service.status === "ENVIADO_GATARINA" ? "selected" : "" %>>
                    Enviado Gatarina
                  </option>
                  <option value="ENVIADO_FFB" <%= service.status === "ENVIADO_FFB" ? "selected" : "" %>>
                    Enviado FFB
                  </option>
                  <option value="RECEBIDO_FFB" <%= service.status === "RECEBIDO_FFB" ? "selected" : "" %>>
                    Recebido FFB
                  </option>
                  <option value="ENVIADO_ASSOCIADO" <%= service.status === "ENVIADO_ASSOCIADO" ? "selected" : "" %>>
                    Enviado ao Associado
                  </option>
                </select>
              </div>
            </div>

            <div class="form-row" style="margin-top:10px;">
              <label>Descri√ß√£o / Observa√ß√µes</label>
              <textarea name="description"><%= service.description || "" %></textarea>
            </div>
          </div>

          <!-- ===================== DADOS DO GATO ===================== -->
          <div class="section-card">
            <div class="section-title">DADOS DO GATO</div>
            <div class="section-helper">
              Informa√ß√µes vinculadas ao pedido de transfer√™ncia.
            </div>

            <div class="section-grid">
              <div class="form-row">
                <label>Nome do gato</label>
                <input type="text" value="<%= cat?.name || '' %>" readonly />
              </div>

              <div class="form-row">
                <label>Microchip</label>
                <input type="text" value="<%= cat?.microchip || '' %>" readonly />
              </div>

              <div class="form-row">
                <label>Ra√ßa</label>
                <input type="text" value="<%= cat?.breed || '' %>" readonly />
              </div>

              <div class="form-row">
                <label>Sexo</label>
                <input
                  type="text"
                  value="<%= cat?.gender === 'M' ? 'Macho' : cat?.gender === 'F' ? 'F√™mea' : '' %>"
                  readonly
                />
              </div>
            </div>
          </div>

          <!-- ===================== TRANSFER√äNCIA ===================== -->
          <div class="section-card">
            <div class="section-title">TRANSFER√äNCIA DE PROPRIEDADE</div>

            <div class="section-grid">
              <div class="form-row">
                <label>Antigo propriet√°rio</label>
                <input type="text" value="<%= transfer?.oldOwnerName || '' %>" readonly />
              </div>

              <div class="form-row">
                <label>Novo propriet√°rio</label>
                <input type="text" value="<%= transfer?.newOwnerName || '' %>" readonly />
              </div>

              <div class="form-row">
                <label>Uso para reprodu√ß√£o</label>
                <input type="text" value="<%= transfer?.breedingStatus || '' %>" readonly />
              </div>

              <% if (transfer?.memberType) { %>
              <div class="form-row">
                <label>Membro FIFe</label>
                <input
                  type="text"
                  value="<%= transfer.memberType === 'FIFE' ? 'Sim' : 'N√£o' %>"
                  readonly
                />
              </div>
              <% } %>
            </div>

            <% if (transfer?.memberType === "NAO_FIFE") { %>
              <div class="section-helper" style="margin-top:10px;">
                Dados adicionais do novo propriet√°rio (n√£o FIFe).
              </div>

              <div class="section-grid">
                <div class="form-row">
                  <label>Endere√ßo</label>
                  <input type="text" value="<%= transfer.address || '' %>" readonly />
                </div>

                <div class="form-row">
                  <label>Bairro</label>
                  <input type="text" value="<%= transfer.district || '' %>" readonly />
                </div>

                <div class="form-row">
                  <label>Cidade</label>
                  <input type="text" value="<%= transfer.city || '' %>" readonly />
                </div>

                <div class="form-row">
                  <label>Estado</label>
                  <input type="text" value="<%= transfer.state || '' %>" readonly />
                </div>

                <div class="form-row">
                  <label>CEP</label>
                  <input type="text" value="<%= transfer.cep || '' %>" readonly />
                </div>

                <div class="form-row">
                  <label>E-mail</label>
                  <input type="text" value="<%= transfer.email || '' %>" readonly />
                </div>

                <div class="form-row">
                  <label>Telefone</label>
                  <input type="text" value="<%= transfer.phone || '' %>" readonly />
                </div>
              </div>
            <% } %>

            <% if (transfer?.authorizationFile) { %>
              <div class="section-helper" style="margin-top:10px; color:#555;">
                üìé Autoriza√ß√£o de Transfer√™ncia: <strong>ANEXADA AO PROCESSO</strong>
              </div>
            <% } %>
          </div>

          <!-- ===================== A√á√ïES ===================== -->
          <div style="display:flex; justify-content:flex-end; gap:8px; margin-top:16px;">
            <a href="/ffb-services" class="btn">Cancelar</a>
            <button type="submit" class="btn btn-primary">
              Salvar altera√ß√µes
            </button>
          </div>

        </form>
      </div>
    </main>
  </div>
</body>
</html>

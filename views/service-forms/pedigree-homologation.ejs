<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Homologa√ß√£o de Pedigree - CaTech</title>

  <link rel="stylesheet" href="/css/theme.css" />
  <link rel="stylesheet" href="/css/layout.css" />
</head>
<body>
<div class="shell">
  <%- include('../partials/sidebar', { user, currentPath }) %>

  <main class="main">
    <div class="header">
      <div>
        <div class="title-main">Homologa√ß√£o de Pedigree</div>
        <div class="title-sub">
          Solicita√ß√£o de homologa√ß√£o de pedigree
        </div>
      </div>
      <div class="header-actions">
        <a href="/services" class="btn">‚Üê Voltar</a>
      </div>
    </div>

    <!-- FORMUL√ÅRIO -->
    <form
  method="post"
  action="/services/pedigree-homologation"
  enctype="multipart/form-data"
>

      <!-- üî¥ ISSO N√ÉO EXISTIA ANTES -->
      <!-- üî¥ ESSA DIV √â O QUE FAZ O FOOTER FUNCIONAR -->
      <div class="content">

        <!-- GATO -->
        <div class="section">
          <div class="section-title"><strong>Gato</strong></div>
          <select name="catId" required>
            <option value="">Selecione o gato...</option>
            <% cats.forEach(c => { %>
              <option value="<%= c.id %>"><%= c.name %></option>
            <% }) %>
          </select>
        

        <div style="margin-top:12px;">
  <label><strong>Propriedade</strong></label>

  <div style="margin-top:6px;">
    <label>
      <input type="radio" name="ownershipDeclaration" value="OWNER" checked />
      Sou propriet√°rio
    </label>
  </div>

  <div>
    <label>
      <input type="radio" name="ownershipDeclaration" value="NOT_OWNER" />
      N√£o sou propriet√°rio
    </label>
  </div>
</div>

<div id="nonOwnerOptions" style="display:none; margin-top:12px;">
  <label><strong>Op√ß√µes</strong></label>

  <div>
    <label>
      <input type="radio" name="transferDecision" value="REQUEST_TRANSFER" />
      Solicitar Transfer√™ncia de Propriedade
    </label>
  </div>

  <div>
    <label>
      <input type="radio" name="transferDecision" value="NO_TRANSFER" />
      N√£o Realizar Transfer√™ncia de Propriedade
    </label>
  </div>
</div>

<div
  id="noTransferWarning"
  style="display:none; margin-top:10px; color:#b71c1c; font-size:0.9rem;"
>
  ‚ö†Ô∏è <strong>
    Solicita√ß√£o de Homologa√ß√£o de Pedigree sem propriedade destina-se
    exclusivamente para Registro de Ninhada, n√£o sendo emitido Pedigree.
  </strong>
</div>
</div>

<div id="transferBox" style="display:none; margin-top:16px;">
  <div class="section">
    <div class="section-title"><strong>Transfer√™ncia de Propriedade</strong></div>

    <div class="grid-2">
      <div class="field">
        <label>Uso para Reprodu√ß√£o</label>
        <select name="breedingStatus">
          <option value="">Selecione...</option>
          <option value="BREEDING">Breeding</option>
          <option value="NOT_FOR_BREEDING">Not For Breeding</option>
        </select>
      </div>

      <div class="field">
        <label>Novo Propriet√°rio</label>
        <input type="text" name="newOwnerName" value="<%= user.name %>" readonly />
      </div>
    </div>

    <div class="field" style="margin-top:10px;">
      <label>Nome do Antigo Propriet√°rio</label>
      <input type="text" name="oldOwnerName" />
    </div>

    <div class="field" style="margin-top:10px;">
      <label>
        Anexar documento de Autoriza√ß√£o de Transfer√™ncia (Obrigat√≥rio)
      </label>
      <input type="file" name="transferAuthorizationFile" />
    </div>
  </div>
</div>


        <!-- TIPO DE HOMOLOGA√á√ÉO -->
        <div class="section">
          <div class="section-title"><strong>Tipo de Homologa√ß√£o</strong></div>
          <select name="homologationType" required>
            <option value="">Selecione...</option>
            <option value="NACIONAL">Homologa√ß√£o Nacional</option>
            <option value="INTERNACIONAL">Homologa√ß√£o Internacional</option>
          </select>
        </div>

      </div>
    
      <!-- REGRAS PARA REGISTRO DE NINHADA -->
<div class="section">
  <div class="section-title"><strong>Regras para Homologa√ß√£o de Pedigree</strong></div>

  <ul class="rules-list">
    <li>
      <strong>√â do criador solicitante a total <strong>responsabilidade</strong> das informa√ß√µes mencionadas neste pedido de Homologa√ß√£o de Pedigree</strong>.
    </li>

    <li>
       Solicita√ß√£o de Homologa√ß√£o de Pedigree <strong>sem propriedade</strong> destina-se exclusivamente para Registro de Ninhada, <strong>n√£o sendo emitido Pedigree</strong>.
    </li>

    <li>
      A FFB, ao Homologar o Pedigree, <strong>n√£o coloca o sufixo do Gatil do novo propriet√°rio</strong>, (exceto quando o gato j√° venha registrado com sufixo por outra Federa√ß√£o)
    </li>

    <li>
      O Pedigree atual deve estar anexado no cadastro do gato.
    </li>

  </ul>
</div>

      <!-- FOOTER DO FORMUL√ÅRIO (IGUAL AO DE TRANSFER√äNCIA) -->
      <div class="footer">
        <a href="/services" class="btn">Cancelar</a>
        <button type="submit" class="btn btn-primary submit-btn">
  <span class="submit-text">Salvar/Enviar</span>
  <span class="spinner" style="display:none; margin-left:8px;"></span>
</button>

      </div>

    </form>
  </main>
</div>

<script>
  const ownershipRadios = document.querySelectorAll(
    'input[name="ownershipDeclaration"]'
  );
  const transferRadios = document.querySelectorAll(
    'input[name="transferDecision"]'
  );

  const nonOwnerOptions = document.getElementById("nonOwnerOptions");
  const noTransferWarning = document.getElementById("noTransferWarning");
  const transferBox = document.getElementById("transferBox");

  ownershipRadios.forEach(r => {
    r.addEventListener("change", () => {
      if (r.value === "NOT_OWNER" && r.checked) {
        nonOwnerOptions.style.display = "block";
      } else {
        nonOwnerOptions.style.display = "none";
        noTransferWarning.style.display = "none";
        transferBox.style.display = "none";
      }
    });
  });

  transferRadios.forEach(r => {
    r.addEventListener("change", () => {
      if (r.value === "NO_TRANSFER" && r.checked) {
        noTransferWarning.style.display = "block";
        transferBox.style.display = "none";
      }

      if (r.value === "REQUEST_TRANSFER" && r.checked) {
        transferBox.style.display = "block";
        noTransferWarning.style.display = "none";
      }
    });
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll("form").forEach((form) => {
      form.addEventListener("submit", () => {
        const submitBtn = form.querySelector("button[type='submit']");
        if (!submitBtn) return;

        const textEl = submitBtn.querySelector(".submit-text");
        const spinnerEl = submitBtn.querySelector(".spinner");

        // bloqueia bot√£o
        submitBtn.disabled = true;

        // altera texto
        if (textEl) {
          textEl.dataset.original = textEl.textContent;
          textEl.textContent = "Processando...";
        }

        // mostra spinner
        if (spinnerEl) {
          spinnerEl.style.display = "inline-block";
        }
      });
    });
  });
</script>

</body>
</html>
